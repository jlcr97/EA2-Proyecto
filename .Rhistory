?jarque.bera.test
??jarque.bera.test
jarque.bera.test(residuals(modeloCDMX))
install.packages("normtest")
jarque.bera.test(residuals(modeloCDMX))
jb.norm.test(residuals(modeloCDMX))
jb.norm.test(residuals(modeloCDMX),nrepl=2000)
jb.norm.test(modeloCDMX$residuals,nrepl=2000)
library(normtest)
jb.norm.test(modeloCDMX$residuals,nrepl=2000)
jb.norm.test(modeloCDMX$residuals,nrepl=2000) #Use Jarque Bera porque ya incluye lo de asimetría y kurtosis
S <-sqrt((sum(modeloCDMX$residuals)^2)/(2169-6))
resi_est <- modeloCDMX$residuals/S
modeloCDMX %>%
ggplot(aes(x=resi_est)) + geom_histogram() + theme_economist_white()
modeloCDMX %>%
ggplot(aes(x=resi_est)) + geom_density() + theme_economist_white()
ggplot(modeloCDMX, aes(x = resi_est ,y = datos$gasto_mon)) +
labs(x = 'Gasto',y = 'Residuos Estandarizados', title = 'Gasto vs. Residuos') +
geom_point() +
theme_economist()
ggplot( aes(x = datos$edad_2 ,y = resi_est)) +
labs(x = 'Gasto',y = 'Residuos Estandarizados', title = 'Gasto vs. Residuos') +
geom_point() +
theme_economist()
ggplot(aes(x = modeloCDMX$gasto_mon ,y = resi_est)) +
labs(x = 'Gasto',y = 'Residuos Estandarizados', title = 'Gasto vs. Residuos') +
geom_point() +
theme_economist()
ggplot(aes(modeloCDMX, x = datos$gasto_mon ,y = resi_est)) +
labs(x = 'Gasto',y = 'Residuos Estandarizados', title = 'Gasto vs. Residuos') +
geom_point() +
theme_economist()
ggplot(aes(modeloCDMX, x = gasto_mon ,y = resi_est)) +
labs(x = 'Gasto',y = 'Residuos Estandarizados', title = 'Gasto vs. Residuos') +
geom_point() +
theme_economist()
ggplot(modeloCDMX, aes( x =gasto_mon ,y = resi_est)) +
labs(x = 'Gasto',y = 'Residuos Estandarizados', title = 'Gasto vs. Residuos') +
geom_point() +
theme_economist()
ggplot(modeloCDMX, aes(x = edad_2 ,y = resi_est)) +
labs(x = '',y = 'Residuos Estandarizados', title = ' vs. Residuos') +
geom_point() +
theme_economist()
ggplot(modeloCDMX, aes(x = edad_2 ,y = resi_est)) +
labs(x = 'Edad^2',y = 'Residuos Estandarizados', title = 'Edad^2 vs. Residuos') +
geom_point() +
theme_economist()
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 8999, ubica_geo < 10000)
ggplot(modeloCDMX, aes(x = erog_totales ,y = resi_est)) +
labs(x = 'Erogaciones Totales',y = 'Residuos Estandarizados', title = 'Datos Atípicos') +
geom_point() +
theme_economist()
ggplot(modeloCDMX, aes(x = erog_tot ,y = resi_est)) +
labs(x = 'Erogaciones Totales',y = 'Residuos Estandarizados', title = 'Datos Atípicos') +
geom_point() +
theme_economist()
ggplot(modeloCDMX, aes(x = datos$erogac_tot ,y = resi_est)) +
labs(x = 'Erogaciones Totales',y = 'Residuos Estandarizados', title = 'Datos Atípicos') +
geom_point() +
theme_economist()
ggplot(modeloCDMX, aes(resi_est)) +
geom_boxplot() +
theme_economist()
S <-sqrt((sum(cdmx$residuals)^2)/(144-6))
resi_est <- fit$residuals/S
S <-sqrt((sum(fit$residuals)^2)/(144-6))
resi_est <- fit$residuals/S
S <-sqrt((sum(modeloCDMX$residuals)^2)/(2169-6))
resi_est <- modeloCDMX$residuals/S
S1 <-sqrt((sum(fit$residuals)^2)/(144-6))
resi_esta <- fit$residuals/S
ggplot(fit, aes(resi_esta)) +
geom_boxplot() +
theme_economist()
fit %>%
ggplot(aes(x=resi_esta)) + geom_density() + theme_economist_white()
ggplot(fit, aes(resi_esta)) +
geom_boxplot() +
theme_economist()
qnt <- quantile(fit, probs=c(.25, .75), na.rm = na.rm, ...)
remove_outliers <- function(fit, na.rm = TRUE) {
qnt <- quantile(fit, probs=c(.25, .75), na.rm = na.rm, ...)
H <- 1.5 * IQR(fit, na.rm = na.rm)
y <- x
y[x < (qnt[1] - H)] <- NA
y[x > (qnt[2] + H)] <- NA
y
}
remove_outliers()
remove_outliers(fit)
ggplot(fit, aes(resi_esta)) +
geom_boxplot() +
theme_economist()
remove_outliers <- function(fit, na.rm = TRUE) {
qnt <- quantile(fit, probs=c(.25, .75), na.rm = na.rm, ...)
H <- 1.5 * IQR(fit, na.rm = na.rm)
y <- x
y[x < (qnt[1] - H)] <- NA
y[x > (qnt[2] + H)] <- NA
y
}
ggplot(fit, aes(resi_esta)) +
geom_boxplot() +
theme_economist()
y <- remove_outliers(fit)
set.seed(1)
fit <- rnorm(100)
fit <- c(-10, x, 10)
fit <- c(-10, fit, 10)
y <- remove_outliers(fit)
fit <- c(-10, fit, 10)
y <- remove_outliers(fit)
?remove_outliers
outlier.test(fit)
outlierTest(fit)
ggplot(fit, aes(resi_esta)) +
geom_histogram() +
theme_economist()
ggplot(fit, aes(resi_esta)) +
geom_histogram() +
theme_economist()
ggplot(aes(resi_esta)) +
geom_histogram() +
theme_economist()
ggplot(cdmx, aes(resi_esta)) +
geom_histogram() +
theme_economist()
cdmx %>% mutate(add_column(resi_esta))
cdmx %>% mutate(add_column(resi_esta))
cdmx %>% mutate(cdmx, resi_esta)
cdmx = mutate(cdmx, resi_esta)
cdmx %>%  mutate(cdmx, resi_esta)
cdmx %>%  mutate( resi_esta)
cdmx %>%  mutate( resi_esta )
cdmx = mutate(cdmx, resi_esta= cdmx$resi_esta)
cdmx = mutate(cdmx, resi_esta = cdmx$resi_esta)
View(cdmx)
cdmx = mutate(fit, resi_esta = fit$residuals)
cdmx = mutate(fit, residuos = fit$residuals)
fit = mutate(fit, residuos = fit$residuals)
fit <- lm(cdmx$ing_cor ~ edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe, cdmx)
cdmx <- df %>%
group_by(gasto_mon) %>%
select(ing_cor, perc_ocupa, erogac_tot, gasto_mon, educa_jefe, edad_jefe) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) #ing_cor < 500000
df <- read_csv("~/Desktop/EA2-Proyecto/BaseDatosEA2.csv")
cdmx <- df %>%
group_by(gasto_mon) %>%
select(ing_cor, perc_ocupa, erogac_tot, gasto_mon, educa_jefe, edad_jefe) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) #ing_cor < 500000
edad_2 = cdmx$edad_jefe^2
df <- read_csv("~/Desktop/EA2-Proyecto/BaseDatosEA2.csv")
View(df)
cdmx <- df %>%
group_by(gasto_mon) %>%
select(ing_cor, perc_ocupa, erogac_tot, gasto_mon, educa_jefe, edad_jefe) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) #ing_cor < 500000
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 8999, ubica_geo < 10000)
library(tidyverse)
datos <- read.csv("BaseDatosEA2.csv")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 8999, ubica_geo < 10000)
cdmx <- df %>%
group_by(gasto_mon) %>%
select(ing_cor, perc_ocupa, erogac_tot, gasto_mon, educa_jefe, edad_jefe) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) #ing_cor < 500000
cdmx <- datos %>%
group_by(gasto_mon) %>%
select(ing_cor, perc_ocupa, erogac_tot, gasto_mon, educa_jefe, edad_jefe) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) #ing_cor < 500000
df <- read_csv("~/Desktop/EA2-Proyecto/BaseDatosEA2.csv")
cdmx <- df %>%
group_by(gasto_mon) %>%
select(ing_cor, perc_ocupa, erogac_tot, gasto_mon, educa_jefe, edad_jefe) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) #ing_cor < 500000
cdmx <- df %>%
group_by(gasto_mon) %>%
select(ing_cor, perc_ocupa, erogac_tot, gasto_mon, educa_jefe, edad_jefe) %>% filter(ubica_geo > 9009, ubica_geo < 9011) #ing_cor < 500000
cdmx <- df %>%
group_by(gasto_mon) %>%
select(ing_cor, perc_ocupa, erogac_tot, gasto_mon, educa_jefe, edad_jefe) %>%
filter(ubica_geo > 9009, ubica_geo < 9011)
cdmx <- df %>%
group_by(gasto_mon) %>%
select(ing_cor, perc_ocupa, erogac_tot, gasto_mon, educa_jefe, edad_jefe) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) #ing_cor < 500000
View(df)
cdmx <- df %>%
group_by(gasto_mon) %>%
select(ing_cor, perc_ocupa, erogac_tot, gasto_mon, educa_jefe, edad_jefe) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) #ing_cor < 500000
#Nueva columna con los errores estandarizados
datos = mutate(datos, resi_est)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe, data = datos)
S <-sqrt((sum(modeloCDMX$residuals)^2)/(2169-6))
resi_est <- modeloCDMX$residuals/S
#Nueva columna con los errores estandarizados
datos = mutate(datos, resi_est)
View(datos)
datos %>% group_by(resi_est)
datos %>% group_by(resi_est) %>% view()
datos %>% arrange(desc(resi_est)) %>% view()
datos %>% arrange(asc(resi_est)) %>% view()
datos %>% arrange(asce(resi_est)) %>% view()
datos %>% arrange(resi_est) %>% view()
datos %>% group_by(resi_est) %>%
view()
#Nueva columna con los errores estandarizados y para el ingreso estimado
datos = mutate(datos, resi_est)
datos = mutate(datos, ing_esti)
datos = mutate(datos, ing_esti = ing_cor + modeloCDMX$residuals )
datos %>% arrange(resi_est) %>%
view()
datos = mutate(datos, ing_esti = ing_cor  )
datos %>% arrange(resi_est) %>%
view()
datos = mutate(datos, ing_esti = ing_cor + resi_est )
datos %>% arrange(resi_est) %>%
view()
ing_esti <- ing_cor + modeloCDMX$residuals
ing_esti <- datos$ing_cor + datos$residuals
ing_esti <- datos$ing_cor + modeloCDMX$residuals
datos = mutate(datos, ing_esti )
datos %>% arrange(resi_est) %>%
view()
ing_esti
view(datos)
negative?binomial
??negativebinomial
?rnbinom
rnbinom(231.62,50,.2)
pnbinom(231.62,50,.2)
?dpois
ppois(231..6210)
ppois(231.62,10)
dpois(231.62,10)
ppois(10,231.62)
ppois(231.62,200)
ppois(0,200)
?pnorm
pnorm((231.62-200+.5)/31.62)
library(tidyverse)
library(readxl)
benef <- read_excel("~/Desktop/Libro4.xlsx)
benef <- read_excel("~/Desktop/Libro4.xlsx)
benef <- read_excel("~/Desktop/Libro4.xlsx")
View(benef)
View(benef)
benef %>% ggplot(aes(anio, esp_mujer,esp_hom,prom))
library(ggthemes)
benef %>% ggplot(aes(x = anio, y = esp_mujer )
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer, fill = country)) +
geom_curve() +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_curve() +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1900, 2020, by = 5)) +
scale_y_continuous(breaks = seq(50, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1900, 2020, by = 5)) +
scale_y_continuous(breaks = seq(0, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(0, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(20, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(30, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_line() +
geom_line(aes(esp_hombre))+
geom_line(aes(prom))+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_line() +
geom_line(aes(benef$esp_hombre))+
geom_line(aes(benef$prom))+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_line(aes( y= esp_hombre))+
geom_line(aes(y = prom))+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point(aes(y = esp_hom, col = "y1")) +
geom_point(aes(y = prom, col = "y2"))
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point(aes(y = esp_hom, col = "y1")) +
geom_point(aes(y = prom, col = "y2")) +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point(aes(y = esp_hom, col = "y1")) +
geom_point(aes(y = prom, col = "y2")) +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_line(aes(y = esp_hom, col = "Esperanza de vida para hombres")) +
geom_line(aes(y = prom, col = "Esperanza de vida promedio")) +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_line(aes(y = esp_hom, col = "Esperanza de vida para hombres")) +
geom_line(aes(y = prom, col = "Esperanza de vida promedio")) +
geom_line()+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer, col = "Esperanza de vida para mujeres")) +
geom_line(aes(y = esp_hom, col = "Esperanza de vida para hombres")) +
geom_line(aes(y = prom, col = "Esperanza de vida promedio")) +
geom_line()+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer, col = "Mujeres")) +
geom_line(aes(y = esp_hom, col = "Hombres")) +
geom_line(aes(y = prom, col = "Promedio")) +
geom_line()+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer, col = "Mujeres")) +
geom_line(aes(y = esp_hom, col = "Hombres")) +
geom_line(aes(y = prom, col = "Promedio")) +
geom_line()+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '') +
theme_bw()
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer, col = "Mujeres")) +
geom_line(aes(y = esp_hom, col = "Hombres")) +
geom_line(aes(y = prom, col = "Promedio")) +
geom_line()+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '') +
theme_economist()
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe, data = datos)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
View(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
View(datos)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad2=datos$edad_jefe^2)
modeloCDMX <- lm(datos$ing_cor ~ edad2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
modeloCDMX <- lm(datos$ing_cor ~ modeloCDMX$edad2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ, data = datos)
View(modeloCDMX)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
summary(modeloCDMX)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_2, ing_cor))+geom_point()
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point()
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point()
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point()
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point()
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
