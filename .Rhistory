library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
dwtest(mCorregido)
dwtest(mCorregido)
HL <- hildreth.lu(y=datos$ing_cor,x=c(datos$edad_jefe, datos$educa_jefe, datos$gasto_mon, datos$erogac_tot), rho=.215)
HL
install.packages("ggthemes")
library(ggthemes)
ggplot(modeloCDMX, aes(x = modeloCDMX$fitted.values ,y = modeloCDMX$residuals)) +
labs(x = 'Ingreso Estimado',y = 'Residuos Estandarizados', title = 'Ingreso Estimado vs. Residuos') +
geom_point() +
theme_economist()
summary(mCorregido)
min(datos$gasto_mon)
6399.78*1.155 + 20*997.229
min(datos$educa_jefe)
6399.78*1.155 + 20*997.229 + 5863.810
min(datos$ing_cor)
max(datos$ing_cor)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
?arima
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
t(datos)
mat <- t(datos) %*% datos
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
datos*2
datos %*% datos
t(datos) %*% datos
datos[-1,]
t(datos) %*% datos
numeric(datos)
as.matrix(datos)
m <- as.matrix(datos)
t(m) %*% m
mat <- t(m) %*% m
eigen(mat)
m <- as.matrix(datos)
mat <- t(m) %*% m
eigen(m)
m <- as.matrix(datos)
mat <- t(m) %*% m
eigen(mat)
m
m <- as.matrix(datos)
m<- m[,-1]
mat <- t(m) %*% m
eigen(mat)
m
m <- as.matrix(datos)
m<- m[,-c(1,2,5,6)]
#mat <- t(m) %*% m
#eigen(mat)
m
m <- as.matrix(datos)
m<- m[,-c(1,2,5,6,7)]
#mat <- t(m) %*% m
#eigen(mat)
m
m <- as.matrix(datos)
m<- m[,-c(1,2,5,6,7)]
mat <- t(m) %*% m
eigen(mat)
eigen(mat)$values[1]
eigen(mat)$values[1] / eigen(mat)$values[4]
norm(m,2)
norm(m)
solve(m)
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
install.packages("matlib")
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
m <- as.matrix(datos)
m<- m[,-c(1,2,5,6,7)]
mat <- t(m) %*% m
eigen(mat)
eigen(mat)$values[1] / eigen(mat)$values[4]
inv(m)
solve(m)
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe -1, datos)
mejoraCDMX
dwtesmejoraCDMX)
dwtest(mejoraCDMX)
cochrane.orcutt(mejoraCDMX)
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
library(stats)
?ar.ols
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
ar.ols(datos)
ar.ols(mejoraCDMX)
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#datos <- datos %>%  #CAUSA ERROR
#select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
#deudas, vestido, transporte) %>%
#filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#nrow(datos)
#head(datos)
#Creamos una nueva columna para la edad al cuadrado
#datos = mutate(datos, edad_2=datos$edad_jefe^2)
#  head(datos)
```
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
dwtest(mCorregido)
install.packages("nlme")
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
library(nlme)
?gls
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
dwtest(mCorregido)
gls(mejoraCDMX,data=datos)
gls(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe,data=datos)
gls(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
type(datos)
typeof(datos)
dato <- as.matrix(datos)
gls(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, dato)
dato <- as.data.frame(datos)
gls(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, dato)
dato <- as.data.frame(datos)
gls(dato$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, dato)
dato <- as.data.frame(datos)
dato
lm(dato$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe)
lm(dato$ing_cor ~ dato$edad_jefe  +dato$erogac_tot + dato$gasto_mon  + dato$educa_jefe)
dato <- as.data.frame(datos)
gls(dato$ing_cor ~ dato$edad_jefe + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe, dato)
dato <- as.data.frame(datos)
gls(dato$ing_cor ~ dato$edad_jefe + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe)
dato$ing_cor
dato <- as.data.frame(datos)
gls(dato$ing_cor ~ dato$edad_jefe + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe)
dato <- as.data.frame(datos)
ing <- datos$ing_cor
gls(ing ~ dato$edad_jefe + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe)
edad - datos$edad_jefe
edad <- datos$edad_jefe
gls(ing ~ dato$edad_jefe + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe)
gls(ing ~ edad + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe)
dato <- as.data.frame(datos)
ing <- datos$ing_cor
edad <- datos$edad_jefe
erog <- datos$erogac_tot
educ <- datos$educa_jefe
gasto <- datos$gasto_mon
gls(ing ~ edad + erog +
gasto + educ)
dato <- as.data.frame(datos)
ing <- datos$ing_cor
edad <- datos$edad_jefe
erog <- datos$erogac_tot
educ <- datos$educa_jefe
gasto <- datos$gasto_mon
glsModel <- gls(ing ~ edad + erog +
gasto + educ)
dwtest(glsModel)
dato <- as.data.frame(datos)
ing <- datos$ing_cor
edad <- datos$edad_jefe
erog <- datos$erogac_tot
educ <- datos$educa_jefe
gasto <- datos$gasto_mon
glsModel <- gls(ing ~ edad + erog +
gasto + educ)
dwtest(glsModel)
dato <- as.data.frame(datos)
ing <- datos$ing_cor
edad <- datos$edad_jefe
erog <- datos$erogac_tot
educ <- datos$educa_jefe
gasto <- datos$gasto_mon
glsModel <- gls(ing ~ edad + erog +
gasto + educ)
summary(glsModel)
glsModel
glsModel <- as.data.frame(glsModel)
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(form = ~ing))
summary(glsModel)
glsModel <- as.data.frame(glsModel)
v <- glsModel$residuals      # get rid of the additional attribute
car::durbinWatsonTest( v )
v <- glsModel$residuals      # get rid of the additional attribute
v
v <- glsModel$residuals
attr(v,"std") <- NULL # get rid of the additional attribute
car::durbinWatsonTest( v )
?corAR1
dato <- as.data.frame(datos)
ing <- datos$ing_cor
edad <- datos$edad_jefe
erog <- datos$erogac_tot
educ <- datos$educa_jefe
gasto <- datos$gasto_mon
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(1,form = ~ing))
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(1,0,0))
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(0.9,0,0))
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(0.9,form = ~ing))
summary(glsModel)
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(1,form = ~ing))
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(form = ~ing))
summary(glsModel)
glsModel$residuals
v <- glsModel$residuals
attr(v,"std") <- NULL
v
v1 <- v[-1]
v1
v1 <- [-144]
v2 <- v[-144]
v2
vD <- (v1-v2)^2
vD
sum(vD)
vSquare <- v^2
vSquare
sum(vSquare)
sumResiduals <- sum(vSquare)
sum(vD)/sumResiduals
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
plot(mCorregido)
plot(mejoraCDMX)
plot(mCorregido)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
typeof(mCorregido)
typeof(mejoraCDMX)
plot(mejoraCD;X)
plot(mejoraCDMX)
plot(mCorregido)
plot(mCorregido)
