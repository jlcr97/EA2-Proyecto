library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
nrow(datos)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#Correlación entre variables
datos%>%
select(edad_jefe, gasto_mon, educa_jefe) %>%
ggcorr(palette = "RdBu", label = TRUE)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
install.packages("ggthemes")
library(ggthemes)
ggplot(modeloCDMX, aes(x = modeloCDMX$fitted.values ,y = modeloCDMX$residuals)) +
labs(x = 'Ingreso Estimado',y = 'Residuos Estandarizados', title = 'Ingreso Estimado vs. Residuos') +
geom_point() +
theme_economist()
media_error <- sum(modeloCDMX$residuals)
S <-sqrt((sum(modeloCDMX$residuals)^2)/(2169-6))
resi_est <- modeloCDMX$residuals/S
modeloCDMX %>%
ggplot(aes(x=resi_est)) + geom_histogram() + theme_economist_white()
modeloCDMX %>%
ggplot(aes(x=resi_est)) + geom_density() + theme_economist_white()
install.packages("normtest")
library(normtest)
jb.norm.test(modeloCDMX$residuals,nrepl=2000) #Use Jarque Bera porque ya incluye lo de asimetría y kurtosis
#Se rechaza la hipótesis nula de que se distribuyen normal
ggplot(modeloCDMX, aes(resi_est)) +
geom_boxplot() +
theme_economist()
#Nueva columna con los errores estandarizados y para el ingreso estimado
datos = mutate(datos, resi_est)
ing_esti <- datos$ing_cor + modeloCDMX$residuals
datos = mutate(datos, ing_esti )
datos %>% arrange(resi_est)
view(datos)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
install.packages("ggthemes")
library(ggthemes)
ggplot(modeloCDMX, aes(x = modeloCDMX$fitted.values ,y = modeloCDMX$residuals)) +
labs(x = 'Ingreso Estimado',y = 'Residuos Estandarizados', title = 'Ingreso Estimado vs. Residuos') +
geom_point() +
theme_economist()
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
nrow(datos)
head(datos)
#Creamos una nueva columna para la edad al cuadrado
#datos = mutate(datos, edad_2=datos$edad_jefe^2)
#  head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
install.packages("ggthemes")
library(ggthemes)
ggplot(modeloCDMX, aes(x = modeloCDMX$fitted.values ,y = modeloCDMX$residuals)) +
labs(x = 'Ingreso Estimado',y = 'Residuos Estandarizados', title = 'Ingreso Estimado vs. Residuos') +
geom_point() +
theme_economist()
media_error <- sum(modeloCDMX$residuals)
S <-sqrt((sum(modeloCDMX$residuals)^2)/(2169-6))
resi_est <- modeloCDMX$residuals/S
modeloCDMX %>%
ggplot(aes(x=resi_est)) + geom_histogram() + theme_economist_white()
modeloCDMX %>%
ggplot(aes(x=resi_est)) + geom_density() + theme_economist_white()
install.packages("normtest")
library(normtest)
jb.norm.test(modeloCDMX$residuals,nrepl=2000) #Use Jarque Bera porque ya incluye lo de asimetría y kurtosis
#Se rechaza la hipótesis nula de que se distribuyen normal
install.packages("ggthemes")
ggplot(modeloCDMX, aes(resi_est)) +
geom_boxplot() +
theme_economist()
#Nueva columna con los errores estandarizados y para el ingreso estimado
datos = mutate(datos, resi_est)
ing_esti <- datos$ing_cor + modeloCDMX$residuals
datos = mutate(datos, ing_esti )
datos %>% arrange(resi_est)
view(datos)
remove_outliers <- function(x, na.rm = TRUE, ...) {
qnt <- quantile(x, probs=c(.25, .75), na.rm = na.rm, ...)
H <- 1.5 * IQR(x, na.rm = na.rm)
y <- x
y[x < (qnt[1] - H)] <- NA
y[x > (qnt[2] + H)] <- NA
y
}
remove_outliers <- function(x, na.rm = TRUE, ...) {
qnt <- quantile(x, probs=c(.25, .75), na.rm = na.rm, ...)
H <- 1.5 * IQR(x, na.rm = na.rm)
y <- x
y[x < (qnt[1] - H)] <- NA
y[x > (qnt[2] + H)] <- NA
y
}
set.seed(1)
x <- rnorm(100)
x <- c(-10, x, 10)
y <- remove_outliers(x)
## png()
par(mfrow = c(1, 2))
boxplot(x)
boxplot(y)
## dev.off()
set.seed(1)
x <- datos
y <- remove_outliers(x)
set.seed(1)
x <- datos
y <- remove_outliers(datos)
bp <- boxplot(datos, outline=FALSE)
bp <- boxplot(datos$ing_cor, outline=FALSE)
x <- datos$ing_cor
y <- remove_outliers(datos)
x <- datos$ing_cor
y <- remove_outliers(x)
## png()
par(mfrow = c(1, 2))
boxplot(x)
boxplot(y)
## dev.off()
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
nrow(datos)
head(datos)
#Creamos una nueva columna para la edad al cuadrado
#datos = mutate(datos, edad_2=datos$edad_jefe^2)
#  head(datos)
datosAt <- read.csv("BaseDatosEA2 Datos atipicos.csv")
view(datosAt)
install.packages(c("HoRM", "lmtest", "orcutt"))
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos.csv")
nrow(datos)
names(datos)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos.csv")
nrow(datos)
names(datos)
view(datos)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#datos <- datos %>%  #CAUSA ERROR
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#datos <- datos %>%  #CAUSA ERROR
#select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
#deudas, vestido, transporte) %>%
#filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#nrow(datos)
#head(datos)
#Creamos una nueva columna para la edad al cuadrado
#datos = mutate(datos, edad_2=datos$edad_jefe^2)
#  head(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
view(datos)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#datos <- datos %>%  #CAUSA ERROR
#select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
#deudas, vestido, transporte) %>%
#filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#nrow(datos)
#head(datos)
#Creamos una nueva columna para la edad al cuadrado
#datos = mutate(datos, edad_2=datos$edad_jefe^2)
#  head(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#datos <- datos %>%  #CAUSA ERROR
#select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
#deudas, vestido, transporte) %>%
#filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#nrow(datos)
#head(datos)
#Creamos una nueva columna para la edad al cuadrado
#datos = mutate(datos, edad_2=datos$edad_jefe^2)
#  head(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
install.packages("orcutt")
library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
mCorregido
install.packages("orcutt")
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
mCorregido
dwtest(mCorregido)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
dwtest(mCorregido)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
HL <- hildreth.lu(y=datos$ing_cor,x=c(edad_jefe, educa_jefe, gasto_mon, erogac_tot), rho=.215)
HL <- hildreth.lu(y=datos$ing_cor,x=c(datos$edad_jefe, datos$educa_jefe, datos$gasto_mon, datos$erogac_tot), rho=.215)
HL <- hildreth.lu(y=datos$ing_cor,x=c(datos$edad_jefe, datos$educa_jefe, datos$gasto_mon, datos$erogac_tot), rho=.215)
HL
