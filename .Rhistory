library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe, data = datos)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
View(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
View(datos)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad2=datos$edad_jefe^2)
modeloCDMX <- lm(datos$ing_cor ~ edad2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
modeloCDMX <- lm(datos$ing_cor ~ modeloCDMX$edad2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ, data = datos)
View(modeloCDMX)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
summary(modeloCDMX)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_2, ing_cor))+geom_point()
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point()
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point()
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point()
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point()
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_2, ing_cor))+geom_point()
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point()
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point()
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point()
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point()
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad, ing_cor))+geom_point()
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point()
ggplot(datos,aes(edad_2, ing_cor))+geom_point()
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point()
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point()
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point()
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point()
datos$erogac_tot
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
#ggplot(datos,aes(edad_2, ing_cor))+geom_point() ya no se considera
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point()
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point()
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point()
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point()
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point() + +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(as.factor(edad_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
sexo_jefe <- as.factor(sexo_jefe)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
sexo_jefe <- as.factor(sexo_jefe)
sexo_jefe <- as.factor(datos$sexo_jefe)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
sexo_jefe <- as.factor(datos$sexo_jefe)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
sexo_jefe <- as.factor(datos$sexo_jefe)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
datos$sexo_jefe <- factor(datos$sexo_jefe)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
levels(datos$sexo_jefe)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
nrow(datos)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
datos <- read.csv("BaseDatosEA2.csv")
view(datos)
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
nrow(datos)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
cor(datos)
var(ddatos)
var(datos)
?cor
cov2cor(datos)
cov2cor(var(datos))
cor(datos)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
nrow(datos)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#Correlación entre variables
datos%>%
select(edad_jefe, perc_ocupa, erogac_tot, gasto_mon, educa_jefe) %>%
ggcorr(palette = "RdBu", label = TRUE)
#Correlación entre variables
datos%>%
select(edad_jefe, erogac_tot, gasto_mon, educa_jefe) %>%
ggcorr(palette = "RdBu", label = TRUE)
#Correlación entre variables
datos%>%
select(edad_jefe, perc_ocupa, erogac_tot, gasto_mon, educa_jefe) %>%
ggcorr(palette = "RdBu", label = TRUE)
#Correlación entre variables
datos%>%
select(edad_jefe, erogac_tot, gasto_mon, educa_jefe) %>%
ggcorr(palette = "RdBu", label = TRUE)
```{r}
#Correlación entre variables
datos%>%
select(edad_jefe, gasto_mon, educa_jefe) %>%
ggcorr(palette = "RdBu", label = TRUE)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(mejoraCDMX)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + gasto_mon + educa_jefe, datos)
summary(mejoraCDMX)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + gasto_mon + educa_jefe, datos)
summary(mejoraCDMX)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + erogac_tot+ gasto_mon + educa_jefe, datos)
summary(mejoraCDMX)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + erogac_tot+ gasto_mon + educa_jefe, datos)
summary(mejoraCDMX)
mejoCDMX <- lm(datos$ing_cor ~ edad_jefe  + sexo_jefe+ gasto_mon + educa_jefe, datos)
summary(mejoraCDMX)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + erogac_tot+ gasto_mon + educa_jefe, datos)
summary(mejoraCDMX)
mejoCDMX <- lm(datos$ing_cor ~ edad_jefe  + sexo_jefe+ gasto_mon + educa_jefe, datos)
summary(mejoCDMX)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + erogac_tot+ gasto_mon + educa_jefe, datos)
summary(mejoraCDMX)
mejoCDMX <- lm(datos$ing_cor ~ edad_jefe  + gasto_mon + educa_jefe, datos)
summary(mejoCDMX)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + erogac_tot+ gasto_mon + educa_jefe, datos)
summary(mejoraCDMX)
mejoCDMX <- lm(datos$ing_cor ~ edad_jefe  + gasto_mon + educa_jefe, datos)
summary(mejoCDMX)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + erogac_tot+ gasto_mon + educa_jefe, datos)
summary(mejoraCDMX)
mejoCDMX <- lm(datos$ing_cor ~ edad_jefe  + sexo_jefe+ gasto_mon + educa_jefe, datos)
summary(mejoCDMX)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
nrow(datos)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c(1,0)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c(1,0)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#Correlación entre variables
datos%>%
select(edad_jefe, gasto_mon, educa_jefe) %>%
ggcorr(palette = "RdBu", label = TRUE)
#Correlación entre variables
datos%>%
select(edad_jefe, gasto_mon, educa_jefe) %>%
ggcorr(palette = "RdBu", label = TRUE)
#Correlación entre variables
datos%>%
select(edad_jefe, gasto_mon, educa_jefe) %>%
ggcorr(palette = "RdBu", label = TRUE)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
