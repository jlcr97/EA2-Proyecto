xfit<-survfit(t~1)
#--- Estimador KM ---
#Calculo del estimador
t<-t2
xfit<-survfit(t~1)
xfit<-survfit(t~1,conf.type="plain")
xfit<-survfit(t~mp6$group,conf.type="log-log")
#Presentacion de estimador
print(xfit)
bill<-read.table("http://allman.rhon.itam.mx/~lnieto/index_archivos/Billete200.txt",header=TRUE)
#--- Crear objeto de superviviencia ---
#Libreria survival
#Opcion 1
t<-Surv(km$time,km$delta)
t1<-Surv(drug6mp$t1,rep(1,length(drug6mp$t1)))
t2<-Surv(drug6mp$t2,drug6mp$relapse)
t<-Surv(bill$Vida,bill$Consecutivo/bill$Consecutivo) # objeto de supervivencia de bill
xfit<-survfit(t~mp6$group,conf.type="log-log")
xfit<-survfit(t~1,conf.type="plain")
xfit<-survfit(t~mp6$group,conf.type="log-log")
bill<-read.table("http://allman.rhon.itam.mx/~lnieto/index_archivos/Billete200.txt",header=TRUE)
t<-Surv(bill$Vida,bill$Consecutivo/bill$Consecutivo) # objeto de supervivencia de bill
xfit<-survfit(t~1)
xfit<-survfit(t~1,conf.type="plain")
xfit<-survfit(t~mp6$group,conf.type="log-log")
#Presentacion de estimador
print(xfit)
summary(xfit)
#Grafica del estimador
par(mfrow=c(1,1))
plot(xfit,conf.int=TRUE)
plot(xfit,conf.int=TRUE,lty=c(1,2,2),col=1:2)
plot(xfit,conf.int=TRUE,lty=c(1,2,2),col=1)
#Informacion que contiene el objeto xfit
names(xfit)
#-Extraccion de tiempos de fallo y supervivencia-
tj<-xfit$time
sj<-xfit$surv
tj<-xfit$time[xfit$n.event!=0]
sj<-xfit$surv[xfit$n.event!=0]
tj<-xfit[group=2]$time[xfit[group=2]$n.event!=0]
sj<-xfit[group=2]$surv[xfit[group=2]$n.event!=0]
k<-length(tj)
sje<-0.5*sj+0.5*c(1,sj[-k])
#-Estimador Nelson-Aalen-
install.packages("mice")
library(mice)
xfit<-survfit(t2~1,conf.type="log-log")
plot(xfit,fun="cumhaz",col=1)
#-Extraccion de tiempos de fallo y supervivencia-
tj<-xfit$time
sj<-xfit$surv
k<-length(tj)
sje<-0.5*sj+0.5*c(1,sj[-k])
#--- Resumenes ---
#Mediana (dentro del comando survfit)
#Media
mean(t)
mean(time[mp6$group==2])
tj2<-c(0,tj[-k])
sj2<-c(1,sj[-k])
means<-sum((tj-tj2)*sj2)
print(means)
print(xfit,rmean=8)
mean(bill$Vida)
head(t)
head(bill$Vida)
mean(bill$Vida)
mean(t)
#-EMV exponencial drug6mp-
m<-100
lam<-seq(0,0.1,,m)
y1<-lik2(lam,drug6mp$t2,drug6mp$relapse)
install.packages(c("candisc", "CCA"))
library(lattice)
library(knitr)
library(tidyverse)
library(aplpack)
library(readr)
library(factoextra)
library(readxl)
library(devtools)
library(ggplot2)
library(corrplot)
library(MASS)
library(lattice)
library(knitr)
library(tidyverse)
library(aplpack)
library(readr)
library(factoextra)
library(readxl)
library(devtools)
library(ggplot2)
library(corrplot)
library(MASS)
library(lattice)
library(knitr)
library(tidyverse)
library(aplpack)
library(readr)
library(factoextra)
library(readxl)
library(devtools)
library(ggplot2)
library(corrplot)
library(MASS)
A <- solve(R22) %*% R21 %*% solve(R11) %*% R12
R11 <- matrix(c(1, 0.615, 0.615, 1), nrow=2, ncol=2, byrow = T)
R12 <- matrix(c(-0.111, -0.266, -0.195, -0.085), nrow=2, ncol=2, byrow = T)
R21 <- t(R12)
R22 <- matrix(c(1, -0.269, -0.269,1), nrow=2, ncol=2, byrow = T)
A <- solve(R22) %*% R21 %*% solve(R11) %*% R12
eigen(A)
(corr1 <- sqrt(0.10668190))
(corr2 <- sqrt(0.02926479))
B <- solve(R11) %*% R12 %*% solve(R22) %*% R21
eigen(B)
eigen$vectors[1]
a <- c(-0.9233,0.3838)
b <- c(-0.5228,0.8524)
a
b
a%*%t(b)
a %*% b
t(b)
t(b) %*%
d
num <- a %*% R12 %*% b
den1 <- sqrt(a %*% R22 %*% a)
den2 <- sqrt(b %*% R11 %*% b)
num / (den1*den2)
num <- t(a) %*% R12 %*% b
num
den1 <- sqrt(t(a) %*% R22 %*% a)
den1
den2 <- sqrt(t(b) %*% R11 %*% b)
den2
num / (den1*den2)
num <- t(a) %*% R12 %*% b
den1 <- sqrt(t(a) %*% R11 %*% a)
den2 <- sqrt(t(b) %*% R22 %*% b)
num / (den1*den2)
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
setwd("C:/Users/Tonantzin Real/Desktop/EA2-Proyecto")
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
dwtest(mCorregido)
HL <- hildreth.lu(y=datos$ing_cor,x=c(datos$edad_jefe, datos$educa_jefe, datos$gasto_mon, datos$erogac_tot), rho=.215)
HL
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
dwtest(mCorregido)
dwtest(mCorregido)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
help("durbin.watson")
help("durbin.watson")
?durbin.watson
?durbinWatsonTest
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
durbinWatsonTest(mmCorregido)
durbinWatsonTest(mCorregido)
durbin.watson(mCorregido)
durbinWatsonTest(mCorregido)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
dwtest(mCorregido)
dwtest(mCorregido)
HL <- hildreth.lu(y=datos$ing_cor,x=c(datos$edad_jefe, datos$educa_jefe, datos$gasto_mon, datos$erogac_tot), rho=.215)
HL
install.packages("ggthemes")
library(ggthemes)
ggplot(modeloCDMX, aes(x = modeloCDMX$fitted.values ,y = modeloCDMX$residuals)) +
labs(x = 'Ingreso Estimado',y = 'Residuos Estandarizados', title = 'Ingreso Estimado vs. Residuos') +
geom_point() +
theme_economist()
summary(mCorregido)
min(datos$gasto_mon)
6399.78*1.155 + 20*997.229
min(datos$educa_jefe)
6399.78*1.155 + 20*997.229 + 5863.810
min(datos$ing_cor)
max(datos$ing_cor)
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
?arima
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
t(datos)
mat <- t(datos) %*% datos
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
datos*2
datos %*% datos
t(datos) %*% datos
datos[-1,]
t(datos) %*% datos
numeric(datos)
as.matrix(datos)
m <- as.matrix(datos)
t(m) %*% m
mat <- t(m) %*% m
eigen(mat)
m <- as.matrix(datos)
mat <- t(m) %*% m
eigen(m)
m <- as.matrix(datos)
mat <- t(m) %*% m
eigen(mat)
m
m <- as.matrix(datos)
m<- m[,-1]
mat <- t(m) %*% m
eigen(mat)
m
m <- as.matrix(datos)
m<- m[,-c(1,2,5,6)]
#mat <- t(m) %*% m
#eigen(mat)
m
m <- as.matrix(datos)
m<- m[,-c(1,2,5,6,7)]
#mat <- t(m) %*% m
#eigen(mat)
m
m <- as.matrix(datos)
m<- m[,-c(1,2,5,6,7)]
mat <- t(m) %*% m
eigen(mat)
eigen(mat)$values[1]
eigen(mat)$values[1] / eigen(mat)$values[4]
norm(m,2)
norm(m)
solve(m)
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
install.packages("matlib")
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
m <- as.matrix(datos)
m<- m[,-c(1,2,5,6,7)]
mat <- t(m) %*% m
eigen(mat)
eigen(mat)$values[1] / eigen(mat)$values[4]
inv(m)
solve(m)
