<<<<<<< HEAD
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
dwtest(mCorregido)
HL <- hildreth.lu(y=datos$ing_cor,x=c(datos$edad_jefe, datos$educa_jefe, datos$gasto_mon, datos$erogac_tot), rho=.215)
HL
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
install.packages("orcutt")
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
install.packages("orcutt")
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
install.packages("orcutt")
install.packages("orcutt")
library(orcutt)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
HL <- hildreth.lu(y=datos$ing_cor,x=c(datos$edad_jefe, datos$educa_jefe, datos$gasto_mon, datos$erogac_tot), rho=.215)
install.packages("hildreth.lu")
media_error <- sum(mCorregido$residuals)
S <-sqrt((sum(mCorregido$residuals)^2)/(144-5))
resi_est <- mCorregido$residuals/S
mCorregido %>%
ggplot(aes(x=resi_est)) + geom_histogram() + theme_economist_white()
ggplot(datos, aes(x=resi_est)) + geom_histogram() + theme_economist_white()
ggplot(datos, aes(x=resi_est)) + geom_histogram() + theme_bw()
media_error <- sum(mCorregido$residuals)
S <-sqrt((sum(mCorregido$residuals)^2)/(144-5))
resi_est <- mCorregido$residuals/S
resi_est <- mCorregido$residuals/S
#primero analizamos la siguiente grafica
ggplot( aes(x = mCorregido$fitted.values ,y = resi_est)) +
labs(x = 'Ingreso Estimado',y = 'Residuos Estandarizados', title = 'Ingreso Estimado vs. Residuos') + geom_point() + theme_bw()
#primero analizamos la siguiente grafica
ggplot(datos, aes(x = mCorregido$fitted.values ,y = resi_est)) +
labs(x = 'Ingreso Estimado',y = 'Residuos Estandarizados', title = 'Ingreso Estimado vs. Residuos') + geom_point() + theme_bw()
#primero analizamos la siguiente grafica
ggplot(datos, aes(x = mCorregido$fitted.values ,y = resi_est)) +
labs(x = 'Ingreso Estimado',y = 'Residuos Estandarizados', title = 'Ingreso Estimado vs. Residuos') + geom_point() + theme_bw()
aux <- lm(ing_cor ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe + edad_jefe^2  + erogac_tot^2 + gasto_mon^2  + educa_jefe^2 + edad_jefe*erogac_tot + edad_jefe*gasto_mon  + edad_jefe*educa_jefe + erogac_tot*gasto_mon  + erogac_tot*educa_jefe + gasto_mon*educa_jefe, datos)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
summary(mCorregido)
#El estadistico de prueba es
nr2 <- 144*7408
#Vemos cómo que los residuos siguen un patron
#Para confirmar hacemos prueba de white
#Regresión Auxiliar
aux <- lm(mCorregido$residuals^2 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe + edad_jefe^2  + erogac_tot^2 + gasto_mon^2  + educa_jefe^2 + edad_jefe*erogac_tot + edad_jefe*gasto_mon  + edad_jefe*educa_jefe + erogac_tot*gasto_mon  + erogac_tot*educa_jefe + gasto_mon*educa_jefe, datos)
qchisq(.95, 14)
qchisq(.05, 14)
#El estadistico de prueba es
nr2 <- 144*7408
144*7408
#El estadistico de prueba es
nr2 <- 144*0.7408
144*0.7408
summary(aux)
#El estadistico de prueba es
nr2 <- 144*0.07749
144*0.07749
qchisq(.05, 14)
qchisq(.95, 14)
qchisq(.05, 14)
#Se rechaza la hipótesis Ho, los residuos son heteroscedasticos
#Para la correción primero observaremos las gráficas de las variables independientes contra los residuos estandarizados para ver si alguna de ellas está involucrada en la falta de constancia de la varianza residual
ggplot(datos,aes(edad_jefe, resi_est))+geom_point() +labs(y= "Residuos Estandarizados", x = "Edad")
ggplot(datos,aes(erogac_tot, resi_est))+geom_point() +labs(y= "Residuos Estandarizados", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, resi_est))+geom_point() +labs(y= "Residuos Estandarizados", x = "Gasto monetario")
ggplot(datos,aes(educa_jefe, resi_est))+geom_point() +labs(y= "Residuos Estandarizados", x = "Años Escolarizados")
$
anova(mCorregido)
Anova(mCorregido)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
anova(mCorregido)
Anova(mCorregido)
summary(mCorregido)
?fdist
pdistf
?pfdist
?qf
qf(.05,3,140)
qf(.95,3,140)
media_error <- sum(mCorregido$residuals)
media_error <- sum(mejoraCDMX$residuals)
media_error <- sum(mejoCDMX$residuals)
media_error <- sum(modeloCDMX$residuals)
media_error <- sum(mCorregido$residuals)
ggplot(datos, aes(x=resi_est)) + geom_histogram() + theme_bw()
resi_est <- mCorregido$residuals/S
ggplot(datos, aes(x=resi_est)) + geom_histogram() + theme_bw()
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
=======
>>>>>>> a17cfb61eb15c864e1611698bf3f6fa0610d7404
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
ggplot(datos, aes(x=resi_est)) + geom_histogram() + theme_bw()
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
mCorregido$coefficients
mCorregido$coefficients <- factor(mCorregido$coefficients)
levels(mCorregido$coefficients) <- c(-52793)
levels(mCorregido$coefficients) <- c(-52793,9.972287e+02,7.012893e-01,1.154722e+00,5.863810e+03 )
9.972287e+02
mCorregido$coefficients
levels(mCorregido$coefficients) <- c(-52793.17,9.972287e+02,7.012893e-01,1.154722e+00,5.863810e+03 )
media_error <- sum(mCorregido$residuals)
mCorregido$Coefficients <- factor(mCorregido$coefficients)
mCorregido$coefficients
mCorregido$residuals
sum(mCorregido$residuals)
summary(mCorregido)
mCorregido$coefficients
?function
??function()
?function()
jf
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
View(datos)
ggplot(datos, aes(x=resi_est)) + geom_histogram() + theme_bw()
transf <- lm(ing_cor^(1/2) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
ggplot(aes(transf$residuals)) + geom_histogram()
ggplot(datos, aes(transf$residuals)) + geom_histogram() + theme_bw()
S_tr<-sum(transf$residuals)/138
S <-sqrt(sum(mCorregido$residuals^2)/(144-5))
resi_est <- mCorregido$residuals/S
ggplot(datos, aes(x=resi_est)) + geom_histogram() + theme_bw()
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
install.packages("normtest")
install.packages("normtest")
library(normtest)
jb.norm.test(transf$residuals,nrepl=2000)
jb.norm.test(mCorregido$residuals,nrepl=2000) #Use Jarque Bera porque ya incluye lo de asimetría y kurtosis
qchisq(.95,2)
transf <- lm(ing_cor ~ edad_jefe^.5  + erogac_tot + gasto_mon  + educa_jefe, datos)
transf <- lm(ing_cor^.5 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot^.5 + gasto_mon  + educa_jefe, datos)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot^(1/2) + gasto_mon  + educa_jefe, datos)
transf <- lm(ing_cor^(1/2) ~ edad_jefe  + erogac_tot^(1/2) + gasto_mon  + educa_jefe, datos)
transf <- lm(ing_cor^(1/2) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot + gasto_mon^2  + educa_jefe, datos)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot + gasto_mon^1/2  + educa_jefe, datos)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot + gasto_mon^2  + educa_jefe, datos)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot + gasto_mon^.2  + educa_jefe, datos)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot + gasto_mon^(0.5)  + educa_jefe, datos)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
#Vemos cómo que los residuos siguen un patron
#Para confirmar hacemos prueba de white
#Regresión Auxiliar
aux <- lm(mCorregido$residuals^2 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe + edad_jefe^2  + erogac_tot^2 + gasto_mon^2  + educa_jefe^2 + edad_jefe*erogac_tot + edad_jefe*gasto_mon  + edad_jefe*educa_jefe + erogac_tot*gasto_mon  + erogac_tot*educa_jefe + gasto_mon*educa_jefe, datos)
transf <- lm(ing_cor ~ edad_jefe  + sqrt(erogac_tot) + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(ing_cor ~ sqrt(edad_jefe)  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot + sqrt(gasto_mon)  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot + gasto_mon  + sqrt(educa_jefe), datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(sqrt(ing_cor) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
# Est. Jarque bera (Normalidad)
library('moments')
sesgo <- skewness(ei.s2)
# Est. Jarque bera (Normalidad)
install.packages("moments")
sesgo <- skewness(transf$residuals/S_tr)
library('moments')
sesgo <- skewness(transf$residuals/S_tr)
sesgo
kurtosis <- kurtosis(transf$residuals/S_tr)
kurtosis
alpha <- .05
JB <- JB <- (144/24)*(sesgo^2*4+(kurtosis-3)^2)
JB
c <- qchisq(.95,2)
c
jb.norm.test(transf$residuals,nrepl=2000)
pchisq(JB,2)
pchisq(JB,2)
JB <-jb.norm.test(mCorregido$residuals,nrepl=2000) #Use Jarque Bera porque ya incluye lo de asimetría y kurtosis
pchisq(JB,2)
JB <-jb.norm.test(mCorregido$residuals,nrepl=2000) #Use Jarque Bera porque ya incluye lo de asimetría y kurtosis
pchisq(JB,2)
jb.norm.test(mCorregido$residuals,nrepl=2000) #Use Jarque Bera porque ya incluye lo de asimetría y kurtosis
pchisq(JB,2)
transf <- lm(sqrt(ing_cor) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(sqrt(ing_cor) ~ sqrt(edad_jefe)  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(sqrt(ing_cor) ~ sqrt(edad_jefe)  + sqrt(erogac_tot) + gasto_mon  + educa_jefe, datos)
transf <- lm(sqrt(ing_cor) ~ sqrt(edad_jefe)  + sqrt(erogac_tot) + sqrt(gasto_mon)  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(sqrt(ing_cor) ~ sqrt(edad_jefe)  + sqrt(erogac_tot) + sqrt(gasto_mon)  + sqrt(educa_jefe), datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(ing_cor ~ sqrt(edad_jefe)  + sqrt(erogac_tot) + sqrt(gasto_mon)  + sqrt(educa_jefe), datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(sqrt(ing_cor) ~ edad_jefe  + sqrt(erogac_tot) + sqrt(gasto_mon)  + sqrt(educa_jefe), datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
pchisq(JB,2)
pchisq(300,2)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
log10()
transf <- lm(log10(ing_cor) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
transf <- lm(log(ing_cor) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(ing_cor ~ log(edad_jefe)  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(ing_cor ~ edad_jefe  + log(erogac_tot) + gasto_mon  + educa_jefe, datos)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot + log(gasto_mon)  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(ing_cor ~ edad_jefe  + erogac_tot + gasto_mon  + log(educa_jefe), datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
transf <- lm(ing_cor ~ edad_jefe  + log(erogac_tot) + gasto_mon  + educa_jefe, datos)
transf <- lm(log(ing_cor) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
ggplot(datos, aes(transf$residuals/S_tr)) + geom_density() + theme_bw()
transf <- lm(ing_cor^.5 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_density() + theme_bw()
transf <- lm(log(ing_cor) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_density() + theme_bw()
ggplot(datos, aes(transf$residuals/S_tr)) + geom_qq() + theme_bw()
geom_qq()
?geom_qq()
ggplot(datos, aes(transf$residuals/S_tr)) + geom_histogram() + theme_bw()
ggplot(datos, aes(transf$residuals/S_tr)) + geom_density() + theme_bw()
#Vemos cómo que los residuos siguen un patron
#Para confirmar hacemos prueba de white
#Regresión Auxiliar
aux <- lm(mCorregido$residuals^2 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe + edad_jefe^2  + erogac_tot^2 + gasto_mon^2  + educa_jefe^2 + edad_jefe*erogac_tot + edad_jefe*gasto_mon  + edad_jefe*educa_jefe + erogac_tot*gasto_mon  + erogac_tot*educa_jefe + gasto_mon*educa_jefe, datos)
summary(aux)
#El estadistico de prueba es
nr2 <- 144*0.07749
qchisq(.05, 14)
qchisq(.95, 14)
qchisq(.95, 5)
#primero analizamos la siguiente grafica
ggplot(datos, aes(x = mCorregido$fitted.values ,y = resi_est)) +
labs(x = 'Ingreso Estimado',y = 'Residuos Estandarizados', title = 'Ingreso Estimado vs. Residuos') + geom_point() + theme_bw()
media_error <- sum(mCorregido$residuals)
#Vemos cómo que los residuos siguen un patron
#Para confirmar hacemos prueba de white
#Regresión Auxiliar
aux <- lm(transf$residuals^2 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe + edad_jefe^2  + erogac_tot^2 + gasto_mon^2  + educa_jefe^2 + edad_jefe*erogac_tot + edad_jefe*gasto_mon  + edad_jefe*educa_jefe + erogac_tot*gasto_mon  + erogac_tot*educa_jefe + gasto_mon*educa_jefe, datos)
summary(aux)
#El estadistico de prueba es
nr2 <- 144*0.07749
qchisq(.95, 14)
mCorregido
mCorregido
mCorregido
mCorregido
#Vemos cómo que los residuos siguen un patron
#Para confirmar hacemos prueba de white
#Regresión Auxiliar
aux <- lm(mCorregido$residuals^2 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe + edad_jefe^2  + erogac_tot^2 + gasto_mon^2  + educa_jefe^2 + edad_jefe*erogac_tot + edad_jefe*gasto_mon  + edad_jefe*educa_jefe + erogac_tot*gasto_mon  + erogac_tot*educa_jefe + gasto_mon*educa_jefe, datos)
summary(aux)
#El estadistico de prueba es
nr2 <- 144*0.07749
qchisq(.95, 14)
#Se rechaza la hipótesis Ho, los residuos son heteroscedasticos
#Para la correción primero observaremos las gráficas de las variables independientes contra los residuos estandarizados para ver si alguna de ellas está involucrada en la falta de constancia de la varianza residual
ggplot(datos,aes(edad_jefe, resi_est))+geom_point() +labs(y= "Residuos Estandarizados", x = "Edad") #Todo bien
#Vemos cómo que los residuos siguen un patron
#Para confirmar hacemos prueba de white
#Regresión Auxiliar
aux <- lm(mCorregido$residuals^2 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe + edad_jefe^2  + erogac_tot^2 + gasto_mon^2  + educa_jefe^2 + edad_jefe*erogac_tot + edad_jefe*gasto_mon  + edad_jefe*educa_jefe + erogac_tot*gasto_mon  + erogac_tot*educa_jefe + gasto_mon*educa_jefe, datos)
summary(aux)
qchisq(.95, 14)
qchisq(.05, 14)
#Vemos cómo que los residuos siguen un patron
#Para confirmar hacemos prueba de white
#Regresión Auxiliar
aux <- lm(transf$residuals^2 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe + edad_jefe^2  + erogac_tot^2 + gasto_mon^2  + educa_jefe^2 + edad_jefe*erogac_tot + edad_jefe*gasto_mon  + edad_jefe*educa_jefe + erogac_tot*gasto_mon  + erogac_tot*educa_jefe + gasto_mon*educa_jefe, datos)
summary(aux)
#El estadistico de prueba es
nr2 <- 144*0.1306
qchisq(.05, 14)
#Vemos cómo que los residuos siguen un patron
#Para confirmar hacemos prueba de white
#Regresión Auxiliar
aux <- lm(mCorregido$residuals^2 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe + edad_jefe^2  + erogac_tot^2 + gasto_mon^2  + educa_jefe^2 + edad_jefe*erogac_tot + edad_jefe*gasto_mon  + edad_jefe*educa_jefe + erogac_tot*gasto_mon  + erogac_tot*educa_jefe + gasto_mon*educa_jefe, datos)
summary(aux)
qchisq(.95, 14)
#El estadistico de prueba es
nr2 <- 144*0.07749
#primero analizamos la siguiente grafica
ggplot(datos, aes(x = mCorregido$fitted.values ,y = resi_est)) +
labs(x = 'Ingreso Estimado',y = 'Residuos Estandarizados', title = 'Ingreso Estimado vs. Residuos') + geom_point() + theme_bw()
jb.norm.test(mCorregido$residuals,nrepl=2000) #Use Jarque Bera porque ya incluye lo de asimetría y kurtosis
transf <- lm(log(ing_cor) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, datos)
summary(transf)
S_tr<-sqrt(sum(transf$residuals^2)/139)
ggplot(datos, aes(transf$residuals/S_tr)) + geom_density() + theme_bw()
jb.norm.test(transf$residuals,nrepl=2000)
jb.norm.test(mCorregido$residuals,nrepl=2000) #Use Jarque Bera porque ya incluye lo de asimetría y kurtosis
ggplot(datos, aes(x=resi_est)) + geom_histogram() + theme_bw()
#Vemos cómo que los residuos siguen un patron
#Para confirmar hacemos prueba de white
#Regresión Auxiliar
aux <- lm(mCorregido$residuals^2 ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe + edad_jefe^2  + erogac_tot^2 + gasto_mon^2  + educa_jefe^2 + edad_jefe*erogac_tot + edad_jefe*gasto_mon  + edad_jefe*educa_jefe + erogac_tot*gasto_mon  + erogac_tot*educa_jefe + gasto_mon*educa_jefe, datos)
summary(aux)
#El estadistico de prueba es
nr2 <- 144*0.07749
qchisq(.95, 14)
jb.norm.test(transf$residuals,nrepl=2000)
qchisq(.95,2)
qchisq(.95, 14)
#El estadistico de prueba es
nr2 <- 144*0.07749
nr2
mco <- read_excel("~/Desktop/Tarea5_EA2.xlsx",
sheet = "Hoja2")
library(tidyverse)
library(readxl)
mco <- read_excel("~/Desktop/Tarea5_EA2.xlsx",
sheet = "Hoja2")
mcg <- read_excel("~/Desktop/Tarea5_EA2.xlsx",
sheet = "Hoja2")
view(mcg)
jb.norm.test(rsid,nrepl=2000)
jb.norm.test(mcg$rsid,nrepl=2000)
jb.norm.test(transf$residuals/S_tr,nrepl=2000)
qchisq(.95,2)
sum(mcg$rsid)
sum(mcg$rsid)/144
sqrt(sum(mcg$rsid^2)/144)
jb.norm.test(mcg$rsid/ss,nrepl=2000)
ss<-sqrt(sum(mcg$rsid^2)/144)
jb.norm.test(mcg$rsid/ss,nrepl=2000)
mcg <- read_csv("~/Desktop/BaseSA.csv")
sin_at <- read_csv("~/Desktop/BaseSA.csv")
view(sin_at)
sin_at <- read_csv("~/Desktop/BaseSA.csv")
view(sin_at)
ss<-sqrt(sum(mcg$rsid^2)/144)
view(sin_at)
view(sin_at)
mod_sa<-lm(sin_at$ing_cor, edad_jefe + educa_jefe + erogac_tot + gasto_mon,sin_at)
mod_sa<-lm(sin_at$ing_cor, sin_at$edad_jefe + educa_jefe + erogac_tot + gasto_mon,sin_at)
mod_sa<-lm(sin_at$ing_cor, sin_at$edad_jefe + sin_at$educa_jefe + sin_at$gasto_mon + sin_at$erogac_tot)
mod_sa<-lm(sin_at$ing_cor ~ edad_jefe + educa_jefe + gasto_mon + erogac_tot, sin_at)
summary(mod_sa)
ss<-sqrt(sum(mod_sa$residuals^2)/139)
jb.norm.test(mcg$rsid/ss,nrepl=2000)
jb.norm.test(mod_sa$residuals/ss,nrepl=2000)
jb.norm.test(mod_sa$residuals,nrepl=2000)
ggplot(aes(x=mod_sa$residuals)) + geom_density() + theme_bw()
ggplot(aes(mod_sa$residuals)) + geom_density() + theme_bw()
ggplot(sin_at,aes(mod_sa$residuals)) + geom_density() + theme_bw()
tra <- lm(log(ing_cor) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, sin_at)
summary(tra)
sss<-sqrt(sum(tra$residuals^2)/139)
ggplot(sin_at, aes(transf$residuals/sss)) + geom_density() + theme_bw()
jb.norm.test(tra$residuals/S_tr,nrepl=2000)
tra <- lm(ing_cor ~ log(edad_jefe)  + erogac_tot + gasto_mon  + educa_jefe, sin_at)
summary(tra)
sss<-sqrt(sum(tra$residuals^2)/139)
ggplot(sin_at, aes(transf$residuals/sss)) + geom_density() + theme_bw()
jb.norm.test(tra$residuals/S_tr,nrepl=2000)
)
tra <- lm(log(ing_cor) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, sin_at)
summary(tra)
sss<-sqrt(sum(tra$residuals^2)/139)
ggplot(sin_at, aes(transf$residuals/sss)) + geom_density() + theme_bw()
jb.norm.test(tra$residuals/S_tr,nrepl=2000)
jb.norm.test(mod_sa$residuals,nrepl=2000)
ggplot(sin_at, aes(transf$residuals)) + geom_density() + theme_bw()
jb.norm.test(tra$residuals/S_tr,nrepl=2000)
qchisq(.95,2)
tra <- lm(ing_cor^(1/2) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, sin_at)
summary(tra)
sss<-sqrt(sum(tra$residuals^2)/139)
ggplot(sin_at, aes(tra$residuals)) + geom_density() + theme_bw()
jb.norm.test(tra$residuals/S_tr,nrepl=2000)
jb.norm.test(tra$residuals/sss,nrepl=2000)
qchisq(.95,2)
tra <- lm(log(ing_cor) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, sin_at)
summary(tra)
sss<-sqrt(sum(tra$residuals^2)/139)
ggplot(sin_at, aes(tra$residuals)) + geom_density() + theme_bw()
baseSA <- read_csv("BaseSA.csv")
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
<<<<<<< HEAD
baseSA <- read.csv("BaseSA.csv")
transf <- lm((ing_cor)^(1/2) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, baseSA)
transf <- lm(ing_cor^(1/2) ~ edad_jefe  + erogac_tot + gasto_mon  + educa_jefe, baseSA)
transf <- lm(ing_cor^(1/2) ~ edad_jefe + erogac_tot + gasto_mon + educa_jefe, baseSA)
baseSA <- read.csv("BaseSA.csv")
transf <- lm(ing_cor^0.5 ~ edad_jefe + erogac_tot + gasto_mon + educa_jefe, baseSA)
transf <- lm(ing_cor ~ edad_jefe + erogac_tot + gasto_mon + educa_jefe, baseSA)
=======
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
library(stats)
?ar.ols
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
ar.ols(datos)
ar.ols(mejoraCDMX)
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#datos <- datos %>%  #CAUSA ERROR
#select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
#deudas, vestido, transporte) %>%
#filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#nrow(datos)
#head(datos)
#Creamos una nueva columna para la edad al cuadrado
#datos = mutate(datos, edad_2=datos$edad_jefe^2)
#  head(datos)
```
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
dwtest(mCorregido)
install.packages("nlme")
library(tidyverse)
library(dplyr)
library(tidyr)
library(matlib)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
library(car)
library(nlme)
?gls
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
#datos <- read.csv("BaseDatosEA2.csv")
#Cambiamos la base porque nos marcaba error en la linea 43, esta base ya esta limpia, solo estan los datos de Alvaro Obregon y las variables que
#pensamos utilizar en el modelo
datos <- read.csv("BaseDatos2.csv")
nrow(datos)
names(datos)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
summary(modeloCDMX)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + est_socio, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
ggplot(datos,aes(as.factor(est_socio), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Estrato socioeconómico")
mejoraCDMX <- lm(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
summary(mejoraCDMX)
plot(mejoraCDMX)
dwtest(mejoraCDMX)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
dwtest(mCorregido)
gls(mejoraCDMX,data=datos)
gls(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe,data=datos)
gls(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, datos)
type(datos)
typeof(datos)
dato <- as.matrix(datos)
gls(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, dato)
dato <- as.data.frame(datos)
gls(datos$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, dato)
dato <- as.data.frame(datos)
gls(dato$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe, dato)
dato <- as.data.frame(datos)
dato
lm(dato$ing_cor ~ edad_jefe  +erogac_tot + gasto_mon  + educa_jefe)
lm(dato$ing_cor ~ dato$edad_jefe  +dato$erogac_tot + dato$gasto_mon  + dato$educa_jefe)
dato <- as.data.frame(datos)
gls(dato$ing_cor ~ dato$edad_jefe + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe, dato)
dato <- as.data.frame(datos)
gls(dato$ing_cor ~ dato$edad_jefe + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe)
dato$ing_cor
dato <- as.data.frame(datos)
gls(dato$ing_cor ~ dato$edad_jefe + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe)
dato <- as.data.frame(datos)
ing <- datos$ing_cor
gls(ing ~ dato$edad_jefe + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe)
edad - datos$edad_jefe
edad <- datos$edad_jefe
gls(ing ~ dato$edad_jefe + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe)
gls(ing ~ edad + dato$erogac_tot +
dato$gasto_mon + dato$educa_jefe)
dato <- as.data.frame(datos)
ing <- datos$ing_cor
edad <- datos$edad_jefe
erog <- datos$erogac_tot
educ <- datos$educa_jefe
gasto <- datos$gasto_mon
gls(ing ~ edad + erog +
gasto + educ)
dato <- as.data.frame(datos)
ing <- datos$ing_cor
edad <- datos$edad_jefe
erog <- datos$erogac_tot
educ <- datos$educa_jefe
gasto <- datos$gasto_mon
glsModel <- gls(ing ~ edad + erog +
gasto + educ)
dwtest(glsModel)
dato <- as.data.frame(datos)
ing <- datos$ing_cor
edad <- datos$edad_jefe
erog <- datos$erogac_tot
educ <- datos$educa_jefe
gasto <- datos$gasto_mon
glsModel <- gls(ing ~ edad + erog +
gasto + educ)
dwtest(glsModel)
dato <- as.data.frame(datos)
ing <- datos$ing_cor
edad <- datos$edad_jefe
erog <- datos$erogac_tot
educ <- datos$educa_jefe
gasto <- datos$gasto_mon
glsModel <- gls(ing ~ edad + erog +
gasto + educ)
summary(glsModel)
glsModel
glsModel <- as.data.frame(glsModel)
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(form = ~ing))
summary(glsModel)
glsModel <- as.data.frame(glsModel)
v <- glsModel$residuals      # get rid of the additional attribute
car::durbinWatsonTest( v )
v <- glsModel$residuals      # get rid of the additional attribute
v
v <- glsModel$residuals
attr(v,"std") <- NULL # get rid of the additional attribute
car::durbinWatsonTest( v )
?corAR1
dato <- as.data.frame(datos)
ing <- datos$ing_cor
edad <- datos$edad_jefe
erog <- datos$erogac_tot
educ <- datos$educa_jefe
gasto <- datos$gasto_mon
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(1,form = ~ing))
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(1,0,0))
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(0.9,0,0))
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(0.9,form = ~ing))
summary(glsModel)
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(1,form = ~ing))
glsModel <- gls(ing ~ edad + erog +
gasto + educ, correlation = corAR1(form = ~ing))
summary(glsModel)
glsModel$residuals
v <- glsModel$residuals
attr(v,"std") <- NULL
v
v1 <- v[-1]
v1
v1 <- [-144]
v2 <- v[-144]
v2
vD <- (v1-v2)^2
vD
sum(vD)
vSquare <- v^2
vSquare
sum(vSquare)
sumResiduals <- sum(vSquare)
sum(vD)/sumResiduals
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
plot(mCorregido)
plot(mejoraCDMX)
plot(mCorregido)
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
#install.packages("orcutt")
#library(orcutt)
mCorregido <- cochrane.orcutt(mejoraCDMX)
summary(mCorregido)
mCorregido
typeof(mCorregido)
typeof(mejoraCDMX)
plot(mejoraCD;X)
plot(mejoraCDMX)
plot(mCorregido)
plot(mCorregido)
>>>>>>> a17cfb61eb15c864e1611698bf3f6fa0610d7404
