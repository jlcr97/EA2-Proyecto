m<-100
a<-seq(0.2,3.8,,m)
b<-seq(0.2,3.8,,m)
y1<-lik4w(a,b,x,seq(1,1,,n))
y2<-lik4w(a,b,tt,delta)
y3<-lik4w(a,b,ttrunc,delta,u)
par(mfrow=c(1,1))
#
contour(a,b,y1,col=1)
pos<-which(y1==max(y1),arr.ind=TRUE)
points(a[pos[1]],b[pos[2]],col=1,pch=15)
print(c(a[pos[1]],b[pos[2]]))
points(a0,b0,col=4,pch=20)
#
contour(a,b,y2,col=2)
pos<-which(y2==max(y2),arr.ind=TRUE)
points(a[pos[1]],b[pos[2]],col=2,pch=15)
print(c(a[pos[1]],b[pos[2]]))
points(a0,b0,col=4,pch=20)
#
contour(a,b,y3,col=3)
pos<-which(y3==max(y3),arr.ind=TRUE)
points(a[pos[1]],b[pos[2]],col=3,pch=15)
print(c(a[pos[1]],b[pos[2]]))
points(alf0,lam0,col=4,pch=20)
#EMV con comando survreg
t<-Surv(tt,delta)
xfitp<-survreg(t~1,dist="weibull")
summary(xfitp)
as<-xfitp$coefficients
bs<-xfitp$scale
alf<-1/bs
lam<-exp(-as/bs)
a<-alf
b<-lam^(-1/alf)
print(c(a,b))
#
xfitp<-survreg(t~1,dist="loglogistic")
summary(xfitp)
#
xfitp<-survreg(t~1,dist="lognormal")
summary(xfitp)
#-Eschmee & Nelson (1977): The number of thousand miles-
#-at which different locomotive controls failed.-
time<-c(22.5,37.5,46,48.5,51.5,53,54.5,57.5,66.5,68,
69.5,76.5,77,78.5,80,81.5,82,83,84,91.5,93.5,102.5,
107,108.5,112.5,113.5,116,117,118.5,119,120,122.5,123,
127.5,131,132.5,134,rep(135,59))
delta<-c(rep(1,37),rep(0,59))
locomotive<-data.frame(time=time,delta=delta)
locomotive
suma(delta)
sum(delta)
sum(delta)/length(delta)
# variable de interés es cantidad de número de millas
t <- Surv(locomotive$time,locomotive$delta)
xfitp<-survreg(t~1,dist="weibull")
summary(xfitp)
#
xfitp<-survreg(t~1,dist="loglogistic")
summary(xfitp)
#
xfitp<-survreg(t~1,dist="lognormal")
summary(xfitp)
bill<-read.table("http://allman.rhon.itam.mx/~lnieto/index_archivos/Billete200.txt",header=TRUE)
dim(bill)
names(bill)
head(bill)
bill<-read.table("http://allman.rhon.itam.mx/~lnieto/index_archivos/Billete200.txt",header=TRUE)
hist(bill$vida)
boxplot(bill$vida)
summary(bill$vida)
dimm(bill)
bill<-read.table("http://allman.rhon.itam.mx/~lnieto/index_archivos/Billete200.txt",header=TRUE)
dim(bill)
names(bill)
boxplot(bill$Vida)
hist(bill$Vida)
boxplot(bill$Vida)
summary(bill$Vida)
t<-Surv(bill$Vida,bill$Consecutivo/bill$Consecutivo) # objeto de supervivencia de bill
xfitp<-survreg(t~1,dist="weibull")
summary(xfitp)
#
xfitp<-survreg(t~1,dist="loglogistic")
summary(xfitp)
#
xfitp<-survreg(t~1,dist="lognormal")
summary(xfitp)
s
t<- seq(0.5,100)
alpha <- 3.484
lam <- 0.5319
a <- alpha
s <- (1/lam)(1/alpha)
n <- length(t)
ft <- dllogis(t,shape=a,scale=s)
par(mfrow=c(1,1))
hist(bill$Vida,freq=FALSE)
linea(t,ft,col=2)
library(survival)
library(KMsurv)
library(actuar)
library(BGPhazard)
library(rmutil)
#-Lognormal-
t<-seq(0,5,100)
mu<--3.177
sigma<-2.084
n<-length(t)
ft<-dlnorm(t,mu,sigma)
st<-1-plnorm(t,mu,sigma)
ht<-ft/st
par(mfrow=c(3,1))
plot(t,ft,type="l") # densidad
plot(t,st,type="l") # supervivencia
plot(t,ht,type="l")
#-Gamma-
t<-18
alpha<-3
lam<-0.2
st<-1-pgamma(t,alpha,lam)
st
t<-12
alpha<-3
lam<-0.2
st<-1-pgamma(t,alpha,lam)
(1-st)
pgamma(t,alpha,lam)
#-Exponencial-
t<-seq(0,10,100)
lam<-exp(-2.38)
n<-length(t)
ft<-dexp(t,lam)
st<-1-pexp(t,lam)
ht<-ft/st
par(mfrow=c(3,1))
plot(t,round(ht,2),type="l")
#-Geometrico-
t<-0:15
p<-0.2
n<-length(t)
ft<-dgeom(t,p)
st<-1-pgeom(t,p)
ht<-ft
ht[2:n]<-ft[-1]/st[-n]
par(mfrow=c(3,1))
plot(t,ht)
library(survival)
library(KMsurv)
library(actuar)
library(BGPhazard)
library(rmutil)
#-Lognormal-
t<-seq(0,5,100)
mu<--3.177
sigma<-2.084
n<-length(t)
ft<-dlnorm(t,mu,sigma)
st<-1-plnorm(t,mu,sigma)
ht<-ft/st
par(mfrow=c(3,1))
plot(t,ft,type="l") # densidad
plot(t,st,type="l") # supervivencia
#--- Carga libreria ---
#-se corre cada vez que se quiera usar-
library(survival)
library(KMsurv)
library(actuar)
library(BGPhazard)
library(rmutil)
#-Lognormal-
t<-seq(0,5,100)
mu<--3.177
sigma<-2.084
n<-length(t)
ft<-dlnorm(t,mu,sigma)
st<-1-plnorm(t,mu,sigma)
ht<-ft/st
par(mfrow=c(3,1))
plot(t,ft,type="l") # densidad
plot(t,st,type="l") # supervivencia
plot(t,ht,type="l")
library(flexsurv)
install.packages("flexsurv")
#-Geometrico-
t<-0:15
p<-0.2
n<-length(t)
ft<-dgeom(t,p)
st<-1-pgeom(t,p)
ht<-ft
ht[2:n]<-ft[-1]/st[-n]
par(mfrow=c(3,1))
plot(t,ft)
plot(t,st)
plot(t,ht)
#-Lognormal-
t<-seq(0,5,100)
mu<--3.177
sigma<-2.084
n<-length(t)
ft<-dlnorm(t,mu,sigma)
st<-1-plnorm(t,mu,sigma)
ht<-ft/st
par(mfrow=c(3,1))
plot(t,ft,type="l") # densidad
plot(t,st,type="l") # supervivencia
plot(t,ht,type="l")
library(flexsurv)
ft<-dlnorm(t,mu,sigma)
st<-1-plnorm(t,mu,sigma)
ht<-ft/st
par(mfrow=c(3,1))
plot(t,ft,type="l") # densidad
#-Loglogistic-
t<-seq(0,5,,100)
alpha<-0.5
lam<-1
a<-alpha
s<-(1/lam)^(1/alpha)
n<-length(t)
ft<-dllogis(t,shape=a,scale=s)
st<-1-pllogis(t,shape=a,scale=s)
ht<-ft/st
par(mfrow=c(3,1))
plot(t,ft,type="l")
plot(t,st,type="l")
plot(t,ht,type="l")
#-Lognormal-
t<-seq(0,10,100)
mu<--2
sigma<-2
n<-length(t)
ft<-dlnorm(t,mu,sigma)
st<-1-plnorm(t,mu,sigma)
ht<-ft/st
par(mfrow=c(3,1))
plot(t,ft,type="l")
plot(t,st,type="l")
plot(t,ht,type="l")
#-Lognormal-
x <- seq(from = 0, to =500, by= 1)
y <- hlnorm(x, meanlog = 3.177, sdlog = 2.084, log = FALSE)
plot(x,y)
#-Lognormal-
x <- seq(from = 0, to =500, by= 1)
y <- hlnorm(x, meanlog = 3.177, sdlog = 2.084, log = FALSE)
plot(x,y)
#-Lognormal-
x <- seq(from = 0, to =500, by= 10)
y <- hlnorm(x, meanlog = 3.177, sdlog = 2.084, log = FALSE)
plot(x,y)
A <- matrix(c(a, b, c, d), 2, 2, byrow=TRUE)
A
A <- matrix(c(a, b, c, d), 2, 2, byrow=TRUE)
A
v1 <- c(sqrt(9865)-95,8)
v1
(v1/norma)
norma <- norm(v1,2)
norma <- norm(v1,2)
norma <- sum(v1*v1)^0.5
(v1/norma)
mat <- matrix(c(1, 4, 4, 100), 2, 2, byrow=TRUE)
mat
eigen(mat)
#--- Carga libreria ---
#-se corre cada vez que se quiera usar-
library(survival)
library(KMsurv)
library(actuar)
library(BGPhazard)
library(rmutil)
bill<-read.table("http://allman.rhon.itam.mx/~lnieto/index_archivos/Billete200.txt",header=TRUE)
hist(bill$Vida)
boxplot(bill$Vida)
summary(bill$Vida)
#-Mas bases de datos-
#De la libreria survival
data(leukemia)
data(bladder)
data(cgd)
data(heart)
data(lung)
data(mgus)
data(nwtco)
data(ovarian)
data(pbc)
data(pbcseq)
data(ratetables)
data(rats)
data(stanford2)
data(tobin)
data(veteran)
#--- Crear objeto de superviviencia ---
#Libreria survival
#Opcion 1
t<-Surv(km$time,km$delta)
t1<-Surv(drug6mp$t1,rep(1,length(drug6mp$t1)))
t2<-Surv(drug6mp$t2,drug6mp$relapse)
t<-Surv(bill$Vida,bill$Consecutivo/bill$Consecutivo) # objeto de supervivencia de bill
t<-Surv(locomotive$time,locomotive$delta)
t<-Surv(leucemia$Time,leucemia$delta)
#Opcion 2
t<-with(km,Surv(time,delta))
#Opcion 3
attach(breakdown)
t<-Surv(time,delta)
t<-Surv(Vida,seq(1,1,,length(Vida)))
#--- Estimador KM ---
#Calculo del estimador
xfit<-survfit(t~1)
#--- Estimador KM ---
#Calculo del estimador
xfit<-survfit(t~1)
xfit<-survfit(t~1,conf.type="plain")
xfit<-survfit(t~mp6$group,conf.type="log-log")
#Presentacion de estimador
print(xfit)
summary(xfit)
#Presentacion de estimador
print(xfit)
summary(xfit)
#--- Estimador KM ---
#Calculo del estimador
t<-t2
xfit<-survfit(t~1)
#--- Estimador KM ---
#Calculo del estimador
t<-t2
xfit<-survfit(t~1)
xfit<-survfit(t~1,conf.type="plain")
xfit<-survfit(t~mp6$group,conf.type="log-log")
#Presentacion de estimador
print(xfit)
bill<-read.table("http://allman.rhon.itam.mx/~lnieto/index_archivos/Billete200.txt",header=TRUE)
#--- Crear objeto de superviviencia ---
#Libreria survival
#Opcion 1
t<-Surv(km$time,km$delta)
t1<-Surv(drug6mp$t1,rep(1,length(drug6mp$t1)))
t2<-Surv(drug6mp$t2,drug6mp$relapse)
t<-Surv(bill$Vida,bill$Consecutivo/bill$Consecutivo) # objeto de supervivencia de bill
xfit<-survfit(t~mp6$group,conf.type="log-log")
xfit<-survfit(t~1,conf.type="plain")
xfit<-survfit(t~mp6$group,conf.type="log-log")
bill<-read.table("http://allman.rhon.itam.mx/~lnieto/index_archivos/Billete200.txt",header=TRUE)
t<-Surv(bill$Vida,bill$Consecutivo/bill$Consecutivo) # objeto de supervivencia de bill
xfit<-survfit(t~1)
xfit<-survfit(t~1,conf.type="plain")
xfit<-survfit(t~mp6$group,conf.type="log-log")
#Presentacion de estimador
print(xfit)
summary(xfit)
#Grafica del estimador
par(mfrow=c(1,1))
plot(xfit,conf.int=TRUE)
plot(xfit,conf.int=TRUE,lty=c(1,2,2),col=1:2)
plot(xfit,conf.int=TRUE,lty=c(1,2,2),col=1)
#Informacion que contiene el objeto xfit
names(xfit)
#-Extraccion de tiempos de fallo y supervivencia-
tj<-xfit$time
sj<-xfit$surv
tj<-xfit$time[xfit$n.event!=0]
sj<-xfit$surv[xfit$n.event!=0]
tj<-xfit[group=2]$time[xfit[group=2]$n.event!=0]
sj<-xfit[group=2]$surv[xfit[group=2]$n.event!=0]
k<-length(tj)
sje<-0.5*sj+0.5*c(1,sj[-k])
#-Estimador Nelson-Aalen-
install.packages("mice")
library(mice)
xfit<-survfit(t2~1,conf.type="log-log")
plot(xfit,fun="cumhaz",col=1)
#-Extraccion de tiempos de fallo y supervivencia-
tj<-xfit$time
sj<-xfit$surv
k<-length(tj)
sje<-0.5*sj+0.5*c(1,sj[-k])
#--- Resumenes ---
#Mediana (dentro del comando survfit)
#Media
mean(t)
mean(time[mp6$group==2])
tj2<-c(0,tj[-k])
sj2<-c(1,sj[-k])
means<-sum((tj-tj2)*sj2)
print(means)
print(xfit,rmean=8)
mean(bill$Vida)
head(t)
head(bill$Vida)
mean(bill$Vida)
mean(t)
#-EMV exponencial drug6mp-
m<-100
lam<-seq(0,0.1,,m)
y1<-lik2(lam,drug6mp$t2,drug6mp$relapse)
install.packages(c("candisc", "CCA"))
library(lattice)
library(knitr)
library(tidyverse)
library(aplpack)
library(readr)
library(factoextra)
library(readxl)
library(devtools)
library(ggplot2)
library(corrplot)
library(MASS)
library(lattice)
library(knitr)
library(tidyverse)
library(aplpack)
library(readr)
library(factoextra)
library(readxl)
library(devtools)
library(ggplot2)
library(corrplot)
library(MASS)
library(lattice)
library(knitr)
library(tidyverse)
library(aplpack)
library(readr)
library(factoextra)
library(readxl)
library(devtools)
library(ggplot2)
library(corrplot)
library(MASS)
A <- solve(R22) %*% R21 %*% solve(R11) %*% R12
R11 <- matrix(c(1, 0.615, 0.615, 1), nrow=2, ncol=2, byrow = T)
R12 <- matrix(c(-0.111, -0.266, -0.195, -0.085), nrow=2, ncol=2, byrow = T)
R21 <- t(R12)
R22 <- matrix(c(1, -0.269, -0.269,1), nrow=2, ncol=2, byrow = T)
A <- solve(R22) %*% R21 %*% solve(R11) %*% R12
eigen(A)
(corr1 <- sqrt(0.10668190))
(corr2 <- sqrt(0.02926479))
B <- solve(R11) %*% R12 %*% solve(R22) %*% R21
eigen(B)
eigen$vectors[1]
a <- c(-0.9233,0.3838)
b <- c(-0.5228,0.8524)
a
b
a%*%t(b)
a %*% b
t(b)
t(b) %*%
d
num <- a %*% R12 %*% b
den1 <- sqrt(a %*% R22 %*% a)
den2 <- sqrt(b %*% R11 %*% b)
num / (den1*den2)
num <- t(a) %*% R12 %*% b
num
den1 <- sqrt(t(a) %*% R22 %*% a)
den1
den2 <- sqrt(t(b) %*% R11 %*% b)
den2
num / (den1*den2)
num <- t(a) %*% R12 %*% b
den1 <- sqrt(t(a) %*% R11 %*% a)
den2 <- sqrt(t(b) %*% R22 %*% b)
num / (den1*den2)
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
setwd("C:/Users/Tonantzin Real/Desktop/EA2-Proyecto")
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(MASS)
library(lmtest)
library(orcutt)
library(HoRM)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
