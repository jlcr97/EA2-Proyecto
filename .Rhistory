pnbinom(231.62,50,.2)
?dpois
ppois(231..6210)
ppois(231.62,10)
dpois(231.62,10)
ppois(10,231.62)
ppois(231.62,200)
ppois(0,200)
?pnorm
pnorm((231.62-200+.5)/31.62)
library(tidyverse)
library(readxl)
benef <- read_excel("~/Desktop/Libro4.xlsx)
benef <- read_excel("~/Desktop/Libro4.xlsx)
benef <- read_excel("~/Desktop/Libro4.xlsx")
View(benef)
View(benef)
benef %>% ggplot(aes(anio, esp_mujer,esp_hom,prom))
library(ggthemes)
benef %>% ggplot(aes(x = anio, y = esp_mujer )
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer, fill = country)) +
geom_curve() +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_curve() +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1900, 2020, by = 5)) +
scale_y_continuous(breaks = seq(50, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1900, 2020, by = 5)) +
scale_y_continuous(breaks = seq(0, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(0, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(20, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(30, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point() +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_line() +
geom_line(aes(esp_hombre))+
geom_line(aes(prom))+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_line() +
geom_line(aes(benef$esp_hombre))+
geom_line(aes(benef$prom))+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_line(aes( y= esp_hombre))+
geom_line(aes(y = prom))+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point(aes(y = esp_hom, col = "y1")) +
geom_point(aes(y = prom, col = "y2"))
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point(aes(y = esp_hom, col = "y1")) +
geom_point(aes(y = prom, col = "y2")) +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_point(aes(y = esp_hom, col = "y1")) +
geom_point(aes(y = prom, col = "y2")) +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_line(aes(y = esp_hom, col = "Esperanza de vida para hombres")) +
geom_line(aes(y = prom, col = "Esperanza de vida promedio")) +
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer)) +
geom_line(aes(y = esp_hom, col = "Esperanza de vida para hombres")) +
geom_line(aes(y = prom, col = "Esperanza de vida promedio")) +
geom_line()+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer, col = "Esperanza de vida para mujeres")) +
geom_line(aes(y = esp_hom, col = "Esperanza de vida para hombres")) +
geom_line(aes(y = prom, col = "Esperanza de vida promedio")) +
geom_line()+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer, col = "Mujeres")) +
geom_line(aes(y = esp_hom, col = "Hombres")) +
geom_line(aes(y = prom, col = "Promedio")) +
geom_line()+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '')
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer, col = "Mujeres")) +
geom_line(aes(y = esp_hom, col = "Hombres")) +
geom_line(aes(y = prom, col = "Promedio")) +
geom_line()+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '') +
theme_bw()
benef %>%
ggplot(mapping = aes(x = anio, y = esp_mujer, col = "Mujeres")) +
geom_line(aes(y = esp_hom, col = "Hombres")) +
geom_line(aes(y = prom, col = "Promedio")) +
geom_line()+
scale_x_continuous(breaks = seq(1960, 2020, by = 10)) +
scale_y_continuous(breaks = seq(40, 80, by = 5)) +
labs(x = 'Año',  y = '',  title = 'Esperanza de vida en México 1960-2017', fill = '') +
theme_economist()
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe, data = datos)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
View(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
View(datos)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad2=datos$edad_jefe^2)
modeloCDMX <- lm(datos$ing_cor ~ edad2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
modeloCDMX <- lm(datos$ing_cor ~ modeloCDMX$edad2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ, data = datos)
View(modeloCDMX)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
summary(modeloCDMX)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_2, ing_cor))+geom_point()
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point()
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point()
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point()
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point()
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_2 + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_2, ing_cor))+geom_point()
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point()
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point()
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point()
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point()
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad, ing_cor))+geom_point()
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point()
ggplot(datos,aes(edad_2, ing_cor))+geom_point()
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point()
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point()
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point()
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point()
datos$erogac_tot
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
#ggplot(datos,aes(edad_2, ing_cor))+geom_point() ya no se considera
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point()
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point()
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point()
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point()
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point() + +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(educa_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(as.factor(edad_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
sexo_jefe <- as.factor(sexo_jefe)
library(tidyverse)
library(dplyr)
library(tidyr)
library(ggplot2)
#install.packages("olsrr"), es para las regresiones
library(olsrr)
#install.packates("GGally"), extensión de ggplot
#install.packages("GGally")
library(GGally)
datos <- read.csv("BaseDatosEA2.csv")
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
sexo_jefe <- as.factor(sexo_jefe)
sexo_jefe <- as.factor(datos$sexo_jefe)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
sexo_jefe <- as.factor(datos$sexo_jefe)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
sexo_jefe <- as.factor(datos$sexo_jefe)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(as.factor(sexo_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
datos$sexo_jefe <- factor(datos$sexo_jefe)
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
levels(datos$sexo_jefe)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
nrow(datos)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
datos <- read.csv("BaseDatosEA2.csv")
view(datos)
nrow(datos)
names(datos)
datos <- datos %>%
select(sexo_jefe,edad_jefe,educa_jefe,tot_integ,perc_ocupa, ubica_geo, est_socio, ing_cor,gasto_mon,otros_gas,ahorro,deposito,retiro_inv,pago_tarje, tabaco, erogac_tot,
deudas, vestido, transporte) %>%
filter(ubica_geo > 9009, ubica_geo < 9011) ##Alvaro Obregon es el 9010
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
nrow(datos)
#Creamos una nueva columna para la edad al cuadrado
datos = mutate(datos, edad_2=datos$edad_jefe^2)
head(datos)
#Esta era el modelo que teníamos del ahorro
#modeloAhorro <- lm(datos$ahorro ~ ing_cor + sexo_jefe + educa_jefe + tot_integ + perc_ocupa + tabaco + erogac_tot, data = datos)
#ols_step_best_subset(modeloAhorro)
#Otras erogaciones: suma de depositos, pago de deudas, tarjetas de crédito, préstamos a otros
#Regresión múltiple lineal entre todas las combinaciones posibles de 8 variables
modeloCDMX <- lm(datos$ing_cor ~ est_socio + edad_2 + perc_ocupa + erogac_tot + gasto_mon + sexo_jefe + educa_jefe + tot_integ + edad_jefe, data = datos)
#Optimiza y muestra las mejores 8 regresiones por número de variables a tomar en cuenta
ols_step_best_subset(modeloCDMX)
#Tomamos la primera que alcanza una R^2 de 0.7 con 5 variables
# Ingreso = edad_2 + perc_ocupa + erogac_tot + gasto_mon + educa_jefe
modeloCDMX <- lm(datos$ing_cor ~ edad_jefe + erogac_tot + gasto_mon + sexo_jefe + educa_jefe, datos)
summary(modeloCDMX)
datos$sexo_jefe <- factor(datos$sexo_jefe)
levels(datos$sexo_jefe) <- c("Hombre","Mujer")
#AGREGUEN MÁS O PÓNGANLAS MÁS BONITAS SI GUSTAN
ggplot(datos,aes(edad_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Edad")
ggplot(datos,aes(erogac_tot, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Erogaciones totales")
ggplot(datos,aes(gasto_mon, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Gasto monetario")
ggplot(datos,aes(sexo_jefe, ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Sexo")
ggplot(datos,aes(as.factor(educa_jefe), ing_cor))+geom_point() +labs(y= "Ingreso corriente", x = "Años escolarizados")
cor(datos)
var(ddatos)
var(datos)
?cor
cov2cor(datos)
cov2cor(var(datos))
cor(datos)
